#region Prolog

#****Begin: Generated Statements***
#****End: Generated Statements****

# =========================================================
# Original Date Created              2015/02/11
# Originator                                 Moravcsik Zsolt
# Purpose                                   General Process to build all cubes from metadata
# Change Date                           
# Change Request Reference    
# Change Made by                     
# =========================================================

# Define variables
vsSysControl = 'zSYS Maintenance Parameter';
vsDimensionExportUNC = CellGetS(vsSysCOntrol, 'Dimension Export UNC','Stype');
vsProcessDebuggingUNC = CellGetS(vsSysCOntrol,'Process Debugging UNC' ,'Stype');
vsLogDirectoryPath = CellGetS(vsSysCOntrol,'Log Directory Path' ,'Stype');
vsProcessName =  GetProcessName();
vsTimeStamp = TIMST(NOW(),'\Y\m\d\h\i\s');
vsDebugFile = vsProcessDebuggingUNC | vsProcessName | ' ' | vsTimeStamp | '.txt';
vsLogFile = vsLogDirectoryPath | vsProcessName | ' ' | vsTimeStamp | '.txt';
cProcess= 'zSYS Maintenance Dimension Import from CSV';
czSYSGRMaintenanceSystemCube ='zSYS Maintenance Cube Dimension Mapping Measure';
cSystemCubesDimensionMapping = 'zSYS Maintenance Cube Dimension Mapping';

#endregion
#region Metadata

#****Begin: Generated Statements***
#****End: Generated Statements****

# & @=

# Destroy the cube if it exists and is required by the parameter
IF(pRebuildCubes @= 'yes' & CubeExists(Cube) = 1);
   IF(pDebug= 1);
      AsciiOutput( vsDebugFile,'Delete cube: '| cube);
   ELSEIF(pDebug=0);
      CubeDestroy (cube);
   ENDIF;
ENDIF;

# If the cube does not exist, create it
IF(CubeExists(Cube) = 0 & ELLEV('zSYS Maintenance System Cube',Cube) = 0);
   imax = DIMSIZ(czSYSGRMaintenanceSystemCube)-2;
   i = 1;

   # Loop through all the dimension positions (cube measure dimension) and find the actual number of existing dimensions of the cube to be created
   WHILE( i <= imax);
      Dim = 'Dim' | NumberToString(i);
      DimName  = CellGetS(cSystemCubesDimensionMapping, Cube, Dim);

      IF(DimensionExists(DimName) = 0 &  DimName @<>'') ;
         IF(pDebug= 1);
            AsciiOutput( vsDebugFile,'Builded cube: '| cube| ' Dimensions: ',DimName);
         ELSEIF(pDebug=0);
            ItemSkip;
         ENDIF;
      ENDIF;

      IF(DimName @<>'');
         IF(pDebug= 1);
            AsciiOutput( vsDebugFile,'Build cube: '| cube| ' Dim count: ', NumberToString(i),NumberToString(imax));
         ELSEIF(pDebug=0);
            DimSzam = i;
         ENDIF;
      ENDIF;
       i = i+1;
   END;

   # Retrieve all dimension names from the system maintenance cube
   DimName1 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim1');
   DimName2 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim2');
   DimName3 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim3');
   DimName4 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim4');
   DimName5 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim5');
   DimName6 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim6');
   DimName7 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim7');
   DimName8 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim8');
   DimName9 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim9');
   DimName10 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim10');
   DimName11 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim11');
   DimName12 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim12');
   DimName13 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim13');
   DimName14 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim14');
   DimName15 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim15');
   DimName16 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim16');
   DimName17 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim17');
   DimName18 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim18');
   DimName19 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim19');
   DimName20 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim20');
   DimName21 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim21');
   DimName22 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim22');
   DimName23 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim23');
   DimName24 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim24');
   DimName25 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim25');
   DimName26 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim26');
   DimName27 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim27');
   DimName28 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim28');
   DimName29 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim29');
   DimName30 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim30');
   DimName31 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim31');
   DimName32 =  CELLGETS(cSystemCubesDimensionMapping, Cube, 'Dim32');

   # Create cube based on the number of its dimensions as specified in the system maintenance cube
   IF(pDebug= 1);
      AsciiOutput( vsDebugFile,'Builded cube: '| cube| ' Dimensions: ',DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28,  DimName29,  DimName30,  DimName31,  DimName32);
   ELSEIF(pDebug=0);
      IF (DimSzam = 1);
         ITEMSKIP;
      ELSEIF (DimSzam = 2);
         CubeCreate(cube, DimName1,  DimName2 );
      ELSEIF (DimSzam = 3);
         CubeCreate(cube, DimName1,  DimName2, Dimname3 );
      ELSEIF (DimSzam = 4);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4);
      ELSEIF (DimSzam = 5);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5 );
      ELSEIF (DimSzam = 6);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6 );
      ELSEIF (DimSzam = 7);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7 );
      ELSEIF (DimSzam = 8);
         CubeCreate(cube, DimName1, DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8 );
      ELSEIF (DimSzam = 9);
         CubeCreate(cube, DimName1,   DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9 );
      ELSEIF (DimSzam = 10);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10);
      ELSEIF (DimSzam = 11);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11);
      ELSEIF (DimSzam = 12);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12);
      ELSEIF (DimSzam = 13);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13);
      ELSEIF (DimSzam = 14);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14);
      ELSEIF (DimSzam = 15);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15);
      ELSEIF (DimSzam = 16);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16);
      ELSEIF (DimSzam = 17);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17);
      ELSEIF (DimSzam = 18);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18);
      ELSEIF (DimSzam = 19);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19);
      ELSEIF (DimSzam = 20);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20);
      ELSEIF (DimSzam = 21);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20, Dimname21);
      ELSEIF (DimSzam = 22);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20, Dimname21, Dimname22);
      ELSEIF (DimSzam = 23);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20, Dimname21, Dimname22,  DimName23);
      ELSEIF (DimSzam = 24);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20, Dimname21, Dimname22,  DimName23, Dimname24);
      ELSEIF (DimSzam = 25);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16,  DimName17,  DimName18,  DimName19,  DimName20, Dimname21, Dimname22,  DimName23, Dimname24, Dimname25);
      ELSEIF (DimSzam = 26);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26);
      ELSEIF (DimSzam = 27);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27);
      ELSEIF (DimSzam = 29);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28);
      ELSEIF (DimSzam = 29);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28,  DimName29);
      ELSEIF (DimSzam = 30);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28,  DimName29,  DimName30);
      ELSEIF (DimSzam = 31);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28,  DimName29,  DimName30,  DimName31);
      ELSEIF (DimSzam = 32);
         CubeCreate(cube, DimName1,  DimName2 , DimName3,  DimName4, DimName5,  DimName6, DimName7,  DimName8, DimName9,  DimName10,  DimName11,  DimName12,  DimName13,  DimName14,  DimName15,  DimName16, DimName17,  DimName18 , DimName19,  DimName20, DimName21,  DimName22, DimName23,  DimName24, DimName25,  DimName26,  DimName27,  DimName28,  DimName29,  DimName30,  DimName31,  DimName32);
      ENDIF;
   ENDIF;
ENDIF;

# If a rule file exists for the cube, attach it
IF(FileExists(Cube | '.rux') =1);
   RuleLoadFromFile(Cube, Cube | '.rux');
ENDIF;
#endregion
#region Data

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
