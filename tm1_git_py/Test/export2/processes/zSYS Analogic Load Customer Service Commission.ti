#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

# =========================================================
# Original Date Created              2024.03.02
# Originator                         Modos David
# Purpose                            
# Change Date                           
# Change Request Reference    
# Change Made by                     Módos Dávid
# =========================================================

# Az adott időszakra csatornánként díj beírása
# Győr - Ügyfélszolgálat
#SET @agentAreaId = 1, @agentTypeId = 1;

# Általános - Call Center Kimenő
#SET @agentAreaId = 10, @agentTypeId = 5;

pChannelDimensionName = 'Channel';
sElementName_Total = 'Channel List Total';


sPeriodDim = 'Period';
sAllNTimeSubset = 'All N';


#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****

#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
IF ( pAllPeriod = 1);

sOriginalDate = vcreatedAt;
sInputDate = DELET (sOriginalDate, 7, 3);
sInputDate = DELET (sInputDate, 5, 1);

sPeriodSubsetName = 'Planning Period';
IF(  SubsetElementExists('Period', sPeriodSubsetName, sInputDate) = 1);
  itemskip;
ENDIF;  

IF(  DimensionElementExists('Period', sInputDate) = 0);
  itemskip;
ENDIF;  


IF ( vprice_category @<> '1 év határozott időre');
 itemskip;
ENDIF;

IF ( vtransactionType @= 'Új szerződés');
 sMovement = 'New';
ENDIF;
IF ( vtransactionType @= 'Megtartó');
 sMovement = 'Retainer';
ENDIF;
IF ( vtransactionType @= 'Felfele migráció - nagy');
 sMovement = 'Upward Migration Big';
ENDIF;
IF ( vtransactionType @= 'Felfele migráció - kicsi');
 sMovement = 'Upward Migration Small';
ENDIF;
nFee = StringToNumber(vcommission);
sProductName = vproduct_name;
CellPutN(nFee, 'Commission', pVersion, sInputDate, '1', 'Customer Service', sProductName, sMovement, 'Commission Fee', 'Value');
#ExecuteProcess('zSYS Analogic UI Commission Fee Input',
#   'pProduct', sProductName,
#   'pValue', vcommission,
#   'pVersion', pVersion,
#   'pPeriod', sInputDate,
#   'pUser', '',
#   'pSalesChannel', 'Customer Service',
#   'pCommission', sMovement
#  );



ENDIF;





IF ( pLastYear = 1);

sOriginalDate = vcreatedAt;
sInputDate = DELET (sOriginalDate, 7, 3);
sInputDate = DELET (sInputDate, 5, 1);

sPeriodSubsetName = 'Last_Actual_Year';
IF(  SubsetElementExists('Period', sPeriodSubsetName, sInputDate) = 0);
  itemskip;
ENDIF;  

IF ( vprice_category @<> '1 év határozott időre');
 itemskip;
ENDIF;

IF ( vtransactionType @= 'Új szerződés');
 sMovement = 'New';
ENDIF;
IF ( vtransactionType @= 'Megtartó');
 sMovement = 'Retainer';
ENDIF;
IF ( vtransactionType @= 'Felfele migráció - nagy');
 sMovement = 'Upward Migration Big';
ENDIF;
IF ( vtransactionType @= 'Felfele migráció - kicsi');
 sMovement = 'Upward Migration Small';
ENDIF;
nFee = StringToNumber(vcommission);
sProductName = vproduct_name;
CellPutN(nFee, 'Commission', pVersion, sInputDate, '1', 'Customer Service', sProductName, sMovement, 'Commission Fee', 'Value');



ENDIF;





#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****

#endregion
