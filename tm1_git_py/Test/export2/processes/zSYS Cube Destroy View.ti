#region Prolog

#****Begin: Generated Statements***
#****End: Generated Statements****

# =========================================================
# Original Date Created              2015/02/03
# Originator                                 Moravcsik Zsolt
# Purpose                                   General Process to destroy cubeview
# Change Date                           
# Change Request Reference    
# Change Made by                     
# =========================================================


####General LOGGING frame###
nRandomNumber = Round ( RAND * 1000000);
sRandomNumber = NumberToString(nRandomNumber);
pStartTime=NumberToString(NOW());
pProcessName =  GetProcessName();
pParams= 'pCubeName|'|pCubeName|'|pViewName|'|pViewName|'|pSubname|'|pSubname;
IF (pLogging = 1);
#ExecuteProcess ('zSYS Process Log Create Entry','pProcessName',pProcessName,'pStartTime',pStartTime,'pParams',pParams,'pRandomNumber',sRandomNumber,'pCallerID',pCallerID);
ENDIF;

####General LOGGING frame###
# & @=

###This is a general process to destroy the given view and the connected subsets
### Use this code to execute this process ExecuteProcess('zSYS Cube Destroy View','pCubeName',pCubeName,'pViewName',pViewName,'pSubName',pSubName);

###DEFINE VARIABLES
vsSysControl = 'zSYS Maintenance Parameter';
vsDimensionExportUNC = CellGetS(vsSysCOntrol, 'Dimension Export UNC','Stype');
vsProcessDebuggingUNC = CellGetS(vsSysCOntrol,'Process Debugging UNC' ,'Stype');
vsLogDirectoryPath = CellGetS(vsSysCOntrol,'Log Directory Path' ,'Stype');
vsProcessName =  GetProcessName();
vsTimeStamp = TIMST(NOW(),'\Y\m\d\h\i\s');
vsDebugFile = vsProcessDebuggingUNC | vsProcessName | ' ' | vsTimeStamp | '.txt';
vsLogFile = vsLogDirectoryPath | vsProcessName | ' ' | vsTimeStamp | '.txt';

# ViewDestroy
IF(ViewExists(pCubeName,pViewName) = 1);
  ViewDestroy(pCubeName, pViewname);
ENDIF;

i = 1;
WHILE (TABDIM (pCubeName,i) @<>''); 
vsDimname = TABDIM (pCubeName,i);

# Subset destroy

IF(SubsetExists(vsDimname, pSubName) = 1);
    SubsetDestroy( vsDimname, pSubName);
ENDIF;

i = i+1;

END;

#endregion
#region Metadata

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog

#****Begin: Generated Statements***
#****End: Generated Statements****

####General LOGGING frame###
IF (pLogging = 1);
#ExecuteProcess('zSYS Process Log Close Entry','pProcessName',pProcessName,'pStartTime',pStartTime,'pRandomNumber',sRandomNumber,'pProcessErrorLogFile',GetProcessErrorFilename);
ENDIF;
####General LOGGING frame###

#endregion
