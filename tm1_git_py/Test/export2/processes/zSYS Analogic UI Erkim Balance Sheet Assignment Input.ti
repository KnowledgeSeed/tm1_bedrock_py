#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

sMeasure = 'Assignment';
sPeriodDim = 'Period';
sAllNTimeSubset = 'Actual Period N level';

nInputValue = 1;

nFirstPeriodIndex = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, pPeriod);
nLastPeriodIndex = SubsetGetSize(sPeriodDim, sAllNTimeSubset);


i = nFirstPeriodIndex;
WHILE(i <= nLastPeriodIndex);
      sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
      CellPutN(nInputValue, 'Erkim Balance Sheet Assignment', pVersion, sInputPeriod, pBalanceSheetLedger, pErkimLedger, sMeasure);
      CellPutS(pErkimLedger, 'Erkim Balance Sheet Assignment', pVersion, sInputPeriod, pBalanceSheetLedger, 'Nem tartozik fokonyhoz', 'ErkimName');
      i = i+1;
END;

LedgerDimName = 'Ledger';
LedgerHierName = 'Ledger';

pLedgerDimensionName = 'Ledger';
sSubsetName_LedgerAllN = 'LedgerAllN';
sMDXLedger = '
{
	TM1FILTERBYLEVEL({
		[ledger].[ledger].Members
	}, 0)
}
';
HierarchySubsetCreate(pLedgerDimensionName, pLedgerDimensionName, sSubsetName_LedgerAllN, 1);
HierarchySubsetMDXSet(pLedgerDimensionName, pLedgerDimensionName, sSubsetName_LedgerAllN, sMDXLedger);

nLedgerSize = SubsetGetSize(LedgerDimName, sSubsetName_LedgerAllN);

#Ha az adott mérleg tétel egy másik erkim-es tétellel volt összerendelve az adott időszakon akkor nullázza
j = 1;

WHILE(j <= nLedgerSize);
  sLedgerName = SubsetGetElementName(LedgerDimName, sSubsetName_LedgerAllN, j);
  i = nFirstPeriodIndex;
  WHILE(i <= nLastPeriodIndex);
    sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);   
    nErkimFlag = CellGetN('Erkim Balance Sheet Assignment', pVersion, sInputPeriod, pBalanceSheetLedger, sLedgerName, sMeasure);
    IF(nErkimFlag = 1 & sLedgerName @<>  pErkimLedger);
      CellPutN(0, 'Erkim Balance Sheet Assignment', pVersion, sInputPeriod, pBalanceSheetLedger, sLedgerName, sMeasure);
    ENDIF;
        i = i+1;
    END;
  j = j+1;
END;
#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****

sToday = Today(1);
CellPutS(sToday, '}ElementAttributes_Version', pVersion, 'Last Updated');
CellPutS(pUser, '}ElementAttributes_Version', pVersion, 'Last Updated By');
#endregion
