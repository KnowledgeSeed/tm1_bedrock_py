#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****
#Region CallThisProcess
# A snippet of code provided as an example how to call this process should the developer be working on a system without access to an editor with auto-complete.

# Módos Dávid fix 2024 01 07

If( 1 = 0 );
    ExecuteProcess( 'zSYS Current Period Subset Update');
EndIf;


### Subset Create ha nem létezik
sDimName = 'Period';
sSubName = 'All N';
sYear_2prev =  STR(Year(Today(1))-2,4,0);

#Y0 nincs használva
sYear_1prev =  STR(Year(Today(1))-1,4,0);

#Y1
sYear =  STR(Year(Today(1)),4,0);
sYear_1next =  STR(Year(Today(1))+1,4,0);
sYear_2next =  STR(Year(Today(1))+2,4,0);
sYear_3next =  STR(Year(Today(1))+3,4,0);
sYear_4next =  STR(Year(Today(1))+4,4,0);


### sSubName = 'Current Period N level';
sSubName = 'Current Period N level';
sMDX = '{
	EXCEPT({
		EXCEPT({
			DRILLDOWNMEMBER(
			{
				[Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'], 
				[Period].[Period].['|sYear_2next|'], [Period].[Period].['|sYear_3next|'], [Period].[Period].['|sYear_4next|']
			},
			{
	      [Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'], 
				[Period].[Period].['|sYear_2next|'], [Period].[Period].['|sYear_3next|'], [Period].[Period].['|sYear_4next|']
			})},{TM1FILTERBYPATTERN({
				[Period].[Period].Members
			}, "*_Input")})},
			{[Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'],
			[Period].[Period].['|sYear_2next|'],[Period].[Period].['|sYear_3next|'],
			[Period].[Period].['|sYear_4next|']})}';

IF(SubsetExists(sDimName, sSubName) = 0);
  SubsetCreatebyMDX(sSubName, sMDX, 0);
ENDIF;

SubsetMDXSet(sDimName, sSubName, sMDX);
SubsetMDXSet(sDimName, sSubName, '');






### sSubName = 'Actual Period N level';
sSubName = 'Actual Period N level';
sMDX = '{
	EXCEPT({
		EXCEPT({
			DRILLDOWNMEMBER(
			{ 
			  [Period].[Period].['|sYear_2prev|'],[Period].[Period].['|sYear_1prev|'],
				[Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'], 
				[Period].[Period].['|sYear_2next|'], [Period].[Period].['|sYear_3next|'], [Period].[Period].['|sYear_4next|']
			},
			{
			  [Period].[Period].['|sYear_2prev|'],[Period].[Period].['|sYear_1prev|'],
	      [Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'], 
				[Period].[Period].['|sYear_2next|'], [Period].[Period].['|sYear_3next|'], [Period].[Period].['|sYear_4next|']
			})},{TM1FILTERBYPATTERN({
				[Period].[Period].Members
			}, "*_Input")})},
			{
			[Period].[Period].['|sYear_2prev|'],[Period].[Period].['|sYear_1prev|'],
			[Period].[Period].['|sYear|'],[Period].[Period].['|sYear_1next|'],
			[Period].[Period].['|sYear_2next|'],[Period].[Period].['|sYear_3next|'],
			[Period].[Period].['|sYear_4next|']})}';

IF(SubsetExists(sDimName, sSubName) = 0);
  SubsetCreatebyMDX(sSubName, sMDX, 0);
ENDIF;

SubsetMDXSet(sDimName, sSubName, sMDX);
SubsetMDXSet(sDimName, sSubName, '');


#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
