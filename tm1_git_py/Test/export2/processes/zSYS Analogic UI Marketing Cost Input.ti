#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

# Mody 2024 05 21
# 1: Gift point average logistics cost
# 2: Gift point average cost
# 3: Árkategóriáért járó bemenet
# 4: Veszélyeztett területen járó bemenet

nRow = StringToNumber(pRow);
IF ( nRow = 3);
 sLineitem = 'Gift point average logistics cost';
ENDIF; 
IF ( nRow = 5);
 sLineitem = 'Bevaltasi arany';
ENDIF;

# pontok
IF ( nRow = 7);
 sLineitem = 'Migrációért járó pontok';
ENDIF;
IF ( nRow = 8);
 sLineitem = 'Arkategoriaert jaro pontok';
ENDIF;
IF ( nRow = 9);
 sLineitem = 'Veszelyeztett teruletertekert jaro pontok';
ENDIF;
IF ( nRow = 10);
 sLineitem = 'Uj szerzodesekert jaro pontok';
 
 
## arany
ENDIF;
IF ( nRow = 12);
 sLineitem = 'Gift point average cost';
ENDIF;
IF ( nRow = 14);
 sLineitem = 'Bevaltasi arany';
ENDIF;

## pontok
IF ( nRow = 16);
 sLineitem = 'Migrációért járó pontok';
ENDIF;
IF ( nRow = 17);
 sLineitem = 'Arkategoriaert jaro pontok';
ENDIF;
IF ( nRow = 18);
 sLineitem = 'Veszelyeztett teruletertekert jaro pontok';
ENDIF;
IF ( nRow = 19);
 sLineitem = 'Uj szerzodesekert jaro pontok';
ENDIF;






nInputValue = stringToNumber(pValue);
sMarketingCostMeasure = 'Value';

sAllNTimeSubset = 'Actual Period N level';
sPeriodDim = 'Period';


#2: more month
  # sima hónap
IF( Long(pPeriod) = 6);
sPeriodStartMonth = pPeriod;
nMaxPlanningPeriodSubsetLen = SubsetGetSize(sPeriodDim, sAllNTimeSubset);
i = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sPeriodStartMonth);
While(i <= nMaxPlanningPeriodSubsetLen);
  sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
  CellPutN(nInputValue, 'Marketing Cost', pVersion, sInputPeriod, sLineitem, sMarketingCostMeasure);
  i = i+1;
END;
ENDIF;

  # éves
  IF( Long(pPeriod) = 4);
    nInputValueHavi = nInputValue\12;
    sPeriodStartMonth = pPeriod | '01';
    nMaxPlanningPeriodSubsetLen = SubsetGetSize(sPeriodDim, sAllNTimeSubset);
    i = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sPeriodStartMonth);
    While(i <= nMaxPlanningPeriodSubsetLen);
      sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
      CellPutN(nInputValue, 'Marketing Cost', pVersion, sInputPeriod, sLineitem, sMarketingCostMeasure);
      i = i+1;
    END;
  
  ENDIF;

#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****



# Módos Dávid 2024 02 13

sToday = Today(1);
CellPutS(sToday, '}ElementAttributes_Version', pVersion, 'Last Updated');
CellPutS(pUser, '}ElementAttributes_Version', pVersion, 'Last Updated By');



#endregion
