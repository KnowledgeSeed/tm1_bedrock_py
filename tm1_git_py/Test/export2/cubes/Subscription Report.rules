SKIPCHECK;
### FEEDER 03
# C-es closing
['Value'] = C:
IF( ELLEV('Period',!Period)>0,
  DB('Subscription Report', !Version, DB('}ElementAttributes_Period', !Period, 'Last_M_Y'), !Loyalty, !Sales Channel, !Product, 'Value'),
  STET); 
  
['Corrected Closing Value'] = C:
IF( ELLEV('Period',!Period)>0,
  DB('Subscription Report', !Version, DB('}ElementAttributes_Period', !Period, 'Last_M_Y'), !Loyalty, !Sales Channel, !Product, 'Value'),
  STET); 


# possible minmax implementation - u.d. - 20231016
# Módos Dávid javítva 2023 11 03

# verzo szabályok
[]= N:
IF(ELISPAR('Version','Report',!Version) = 1,
STET,Continue);



['Loyalty':'0', 'Sales Channel':'Customer Service', 'Subscription Report Measure':'Maximum'] = N:
ConsolidatedMin(2, 'Weight and Limit', !Version, !Period, !Product, 'Maximum', 'Value');

['Loyalty':'0', 'Sales Channel':'Customer Service', 'Subscription Report Measure':'Minimum'] = N:
ConsolidatedMax(2, 'Weight and Limit', !Version, !Period, !Product, 'Minimum', 'Value');

['Loyalty':'0', 'Sales Channel':'Customer Service','Subscription Report Measure':'Out of bounds'] = N:
max(0, sign(['Minimum']-['Loyalty':'Total', 'Sales Channel':'Total','Subscription Report Measure':'Value'])) *
(['Loyalty':'Total', 'Sales Channel':'Total','Subscription Report Measure':'Value'] - ['Minimum'])
+ max(0, sign(['Loyalty':'Total', 'Sales Channel':'Total','Subscription Report Measure':'Value']-['Maximum'])) *
(['Loyalty':'Total', 'Sales Channel':'Total','Subscription Report Measure':'Value']-['Maximum']);


FEEDERS;
['Subscription Report Measure':{'Minimum','Maximum','Value'},'Version':'Forecast'] => ['Subscription Report Measure':'Out of Bounds'];

# Revenue FEEDEREK START
# E/2:modem szabályok
# darab (TM1) tény és terv időszakba is a naturáliából
['Subscription Report Measure':'Value','Product':'543','Version':'Forecast'] =>
DB('Revenue', !Version, !Period, '91502', 'Nem tartozik termekhez', 'Efi szam', 'Value');
# E/3: dekóder STB
['Subscription Report Measure':'Value','Product':{'199','200','201','202','203'},'Version':'Forecast'] =>
DB('Revenue', !Version, !Period, '91501', 'Nem tartozik termekhez', 'Efi szam', 'Value');

['Subscription Report Measure':'Value','Version':'Forecast'] =>
DB('Revenue', !Version, !Period, 'Revenue', '91101', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91201', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91202', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91301', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91302', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91303', 'Efi szam', 'Value'),
DB('Revenue', !Version, !Period, 'Revenue', '91401', 'Efi szam', 'Value')
;
# Revenue FEEDEREK END



['Subscription Report Measure':'Value', 'Version':'Forecast' ] =>
DB('XP Planning', !Version, !Period, 'TV Calculated from Naturalia', 'Value'),
DB('XP Planning', !Version, !Period, 'NET Calculated from Naturalia', 'Value'),
DB('XP Planning', !Version, !Period, 'TEL Calculated from Naturalia', 'Value');

### Channel Cost feeder
#['Subscription Report Measure':'Value','Product':'KTV Alaptermék Total','Version':'Base'] =>
#DB('Channel Cost', !Version, !Period, 'Channel':'Channel Cost Total', !Product, 'Currency':'Currency Total', 'EFI', 'Value')
#;
##
#### Channel Cost feeder
#['Subscription Report Measure':'Value','Product':'KTV kiegészítő Total','Version':'Base'] =>
#DB('Channel Cost', !Version, !Period, 'Channel':'Channel Cost Total', !Product, 'Currency':'Currency Total', 'EFI', 'Value')
#;

## Channel Cost feeder
['Subscription Report Measure':'Value','Product':'KTV Alaptermék Lakossági Total','Version':'Forecast'] =>
DB('Channel Cost', !Version, !Period, 'Channel':'Channel Cost Total', !Product, 'Currency':'Currency Total', 'EFI', 'Value')
;


## Channel Cost feeder
['Subscription Report Measure':'Value','Product':'KTV kiegészítő Lakossági Total','Version':'Forecast'] =>
DB('Channel Cost', !Version, !Period, 'Channel':'Channel Cost Total', !Product, 'Currency':'Currency Total', 'EFI', 'Value')
;

#Botond 24.04.25
#Individual Cost EFI Szám feeder
['Subscription Report Measure':'Value','Product':{'Telefon Lakossági Total','Telefon ADSL Total'},'Version':'Forecast'] =>
DB('Individual Cost', !Version, !Period, 'Total', 'Efi szam', 'Value');









