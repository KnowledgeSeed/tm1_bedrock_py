#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

# Mody 2024 01 12

#pMode
#1: one month
#2: more month

nInputValue = stringToNumber(pValue);
sRevenueMeasre = 'Value';
# 91401	Eszköz értékesítés bevétele
sLedger = '91401';
sProduct= 'Nem tartozik termekhez';

sAllNTimeSubset = 'Actual Period N level';
sPeriodDim = 'Period';

# Efiszám
IF(pLineitem = 0);
  sValosLineitem = 'Efi szam';
ELSEIF(pLineitem = 1);
  sValosLineitem = 'ARPU';  
ELSEIF(pLineitem = 3);
  sValosLineitem = 'Koltseg Rata';
  nInputValue = nInputValue \ 100; 
ENDIF;

#1: one value
IF(pMode = 1);
  # sima hónap
    IF( Long(pPeriod) = 6);
      CellPutN(nInputValue, 'Revenue', pVersion, pPeriod, sLedger, sProduct, sValosLineitem, sRevenueMeasre);
    ENDIF;
  # éves
  IF( Long(pPeriod) = 4);
    nInputValueHavi = nInputValue /12;
    i=1;
    WHILE( i<=12);
      sActualPeriod = pPeriod | numberToString(i);
      IF( i<10);
        sActualPeriod = pPeriod | '0' | numberToString(i);
      ENDIF;
      CellPutN(nInputValueHavi, 'Revenue', pVersion, sActualPeriod, sLedger, sProduct, sValosLineitem, sRevenueMeasre);
      i=i+1;
    END;
    ENDIF;
  #1: one value end
  ENDIF;

  #2: more month
  IF(pMode = 2);
    # sima hónap
    IF( Long(pPeriod) = 6);
      sPeriodStartMonth = pPeriod;
      nMaxPlanningPeriodSubsetLen = SubsetGetSize(sPeriodDim, sAllNTimeSubset);
      i = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sPeriodStartMonth);
      While(i <= nMaxPlanningPeriodSubsetLen);
        sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
        CellPutN(nInputValue, 'Revenue', pVersion, sInputPeriod, sLedger, sProduct, sValosLineitem, sRevenueMeasre);
        i = i+1;
      END;
    ENDIF;
    
    # éves
    IF( Long(pPeriod) = 4);
      nInputValueHavi = nInputValue /12;
      sPeriodStartMonth = pPeriod | '01';
      nMaxPlanningPeriodSubsetLen = SubsetGetSize(sPeriodDim, sAllNTimeSubset);
      i = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sPeriodStartMonth);
      While(i <= nMaxPlanningPeriodSubsetLen);
        sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
        CellPutN(nInputValueHavi, 'Revenue', pVersion, sInputPeriod, sLedger, sProduct, sValosLineitem, sRevenueMeasre);
        i = i+1;
      END;
    
    ENDIF;
  ##2: more month
  ENDIF;





#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****
# Módos Dávid 2024 02 13

sToday = Today(1);
CellPutS(sToday, '}ElementAttributes_Version', pVersion, 'Last Updated');
CellPutS(pUser, '}ElementAttributes_Version', pVersion, 'Last Updated By');



#endregion
