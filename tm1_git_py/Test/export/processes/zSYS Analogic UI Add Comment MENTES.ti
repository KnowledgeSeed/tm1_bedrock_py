#region Prolog

#****Begin: Generated Statements***
#****End: Generated Statements****

ASCIIOUTPUT('Comment Variables.txt', pUser, pPrevCommentID, pCube, pComment, pDimFilter);
sCommentCube = 'Comment By ID';
sDim='Comment ID';
nCurrentID= DimSiz(sDim)+1;
sCurrentID = NumberToString(nCurrentID);
nLongCurrentiD= LONG(sCurrentID);
sNewID='comment'|FILL('0',8 - nLongCurrentiD)|sCurrentID;

IF (pPrevCommentID@<>'' &  DIMIX(sDim, pPrevCommentID)=0);
  LogOutput('ERROR', 'Non existing ID');
  ProcessQuit;
Endif;

  IF(DimensionElementExists(sDim, sNewID) = 0);
    DimensionElementInsertDirect(sDim, '', sNewID ,'N');
  ENDIF;
#endregion
#region Metadata

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Epilog

#****Begin: Generated Statements***
#****End: Generated Statements****

Cellputs(pUser,sCommentCube,sNewID,'CommentUser');
Cellputs(pPrevCommentID,sCommentCube,sNewID,'PreviousCommentID');
Cellputs(pComment,sCommentCube,sNewID,'CommentText');
Cellputs(sNewID,sCommentCube,sNewID,'CommentID');
sTime= TimSt(NOW(), '\Y.\m.\d \h:\i');
Cellputs(sTime,sCommentCube,sNewID,'CommentDate');
Cellputs(pCube,sCommentCube,sNewID,'CommentedCube');
Cellputs(pDimFilter,sCommentCube,sNewID,'CommentedCubeFilter');

#register comment
nDimCount=CubeDimensionCountGet(pCube);

sDim1='';
nCommPos=Scan(',',pDimFilter);
sDim1= Subst(pDimFilter,1,nCommPos-1);
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim2='';
nCommPos=Scan(',',pDimFilter);
sDim2= Subst(pDimFilter,1,nCommPos-1);
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim3='';
nCommPos=Scan(',',pDimFilter);
sDim3= Subst(pDimFilter,1,nCommPos-1);
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim4='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=4);
sDim4 =pDimFilter;
else;
sDim4= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim5='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=5);
sDim5 =pDimFilter;
else;
sDim5= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim6='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=6);
sDim6 =pDimFilter;
else;
sDim6= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim7='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=7);
sDim7 =pDimFilter;
Else;
sDim7= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim8='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=8);
sDim8 =pDimFilter;
Else;
sDim8= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim9='';
nCommPos=Scan(',',pDimFilter);
IF(nDimCount=9);
sDim9 =pDimFilter;
Else;
sDim9= Subst(pDimFilter,1,nCommPos-1);
Endif;
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

sDim10='';
nCommPos=Scan(',',pDimFilter);
sDim10= Subst(pDimFilter,1,nCommPos-1);
pDimFilter = Subst(pDimFilter,nCommPos+1,Long(pDimFilter) - nCommPos);

  LogOutput('INFO', Numbertostring(nDimCount)|','|pCube|','|sdim1|','|sdim2|','|sdim3|','|sdim4|','|sdim5|','|sdim6|','|sdim7|','|sDim8|','|sdim9);

IF( nDimCount = 3);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Elseif( nDimCount = 4);
  If ( CellIsUpdateable(pCube, 'Fiscal Year':sdim1, sdim2, sdim3,sdim4)=1);
    Cellputs(sNewID,pCube, 'Fiscal Year':sdim1, sdim2, sdim3,sdim4);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
  
  
##########################################


Elseif( nDimCount = 5);
  If ( CellIsUpdateable(pCube, sdim1, sdim2, sdim3,sdim4,sdim5)=1);
    Cellputs(sNewID,pCube, sdim1, sdim2, sdim3,sdim4,sdim5);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
  
  
  
##########################################


Elseif( nDimCount = 6);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Elseif( nDimCount = 7);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Elseif( nDimCount = 8);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sdim8)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sdim8);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Elseif( nDimCount = 9);
  LogOutput('INFO', pCube|','|sdim1|','|sdim2|','|sdim3|','|sdim4|','|sdim5|','|sdim6|','|sdim7|','|sDim8|','|sdim9);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sDim8,sdim9)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sDim8,sdim9);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Elseif( nDimCount = 10);
  If ( CellIsUpdateable(pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sdim8,sdim9,sdim10)=1);
    Cellputs(sNewID,pCube, sdim1, 'Fiscal Year':sdim2, sdim3,sdim4,sdim5,sdim6,sdim7,sdim8,sdim9,sdim10);
  Else;
      LogOutput('ERROR', 'Incorrect target cube or filter to save comment id:'| pCube | ' filter:'|pDimFilter| ' CommentId lost:'|sNewID);
  Endif;
Endif;  




#endregion
