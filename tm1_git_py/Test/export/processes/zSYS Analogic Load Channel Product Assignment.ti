#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

# =========================================================
# Original Date Created              2024.03.02
# Originator                         Modos David
# Purpose                            
# Change Date                           
# Change Request Reference    
# Change Made by                     Módos Dávid
# =========================================================

# 1, chnnel_id berakása total channel alá
# 2, channel name kitöltése

# 3, az adott időszakra adott termék-be hozzárendelés kitöltése

pChannelDimensionName = 'Channel';
sElementName_Total = 'Channel List Total';


sPeriodDim = 'Period';
sAllNTimeSubset = 'All N';



#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
# Ha az elem nem létezik
#   -total elem alá betenni
#   -Attributumot beírni


IF ( DimensionElementExists(pChannelDimensionName , vchannel_id) = 0);
  DimensionElementComponentAddDirect(pChannelDimensionName, sElementName_Total,vchannel_id, 1);
  CellPutS(vchannel_name, '}ElementAttributes_Channel', vchannel_id, 'Caption');
ENDIF;

#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****
# startData
sStartDate = vstart_date;
sStartDate = DELET(sStartDate, 8,3);
sStartDate = DELET(sStartDate, 5,1);

# idáig
sEndDate = vend_date;
sEndDate = DELET(sEndDate, 8,3);
sEndDate = DELET(sEndDate, 5,1);
nEllEgy = DimensionElementExists(sPeriodDim , sStartDate);
IF( vend_date @='');
  nEllKetto = 0;
ENDIF;
nEll = nEllEgy + nEllKetto;

IF ( nEll = 0 );
  sBejon = '';
  #itemskip;
ENDIF;

IF ( DimensionElementExists(sPeriodDim , sStartDate) = 0);
 sStartDate = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, 1);
ENDIF;

# ha még tart akkor végig
IF ( vend_date @= '');
  nMaxLong = SubsetGetSize(sPeriodDim, sAllNTimeSubset);
  sEndDate = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, nMaxLong);
ENDIF;

starDateIndex = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sStartDate);
endDateIndex = SubsetElementGetIndex(sPeriodDim, sAllNTimeSubset, sEndDate);


IF(stringToNumber(pAllPeriod) = 1);
sPeriodSubsetName = 'Planning Period';
i = starDateIndex;
    While(i <= endDateIndex);
      sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
        CellPutN(1, 'Channel Product Assignment', pVersion, sInputPeriod, vchannel_id, vnatural_name, 'Assignment');
        
      i = i+1;
      
    END;

#Endif pAllPeriod
ENDIF;

IF( stringToNumber(pLastYear) = 1);
  sPeriodSubsetName = 'Last_Actual_Year';
  i = starDateIndex;
  While(i <= endDateIndex);
    sInputPeriod = SubsetGetElementName(sPeriodDim, sAllNTimeSubset, i);
    IF ( SubsetElementExists('Period', sPeriodSubsetName, sInputPeriod) = 1);
      CellPutN(1, 'Channel Product Assignment', pVersion, sInputPeriod, vchannel_id, vnatural_name, 'Assignment');
    ENDIF;
      i = i+1;
   END;

#Endif pLastYear
ENDIF;






#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****

#endregion
