#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****

# CSAK A DEMO miatt használni

If( 1 = 0 );
    ExecuteProcess('zSYS Analogic Delete And Load All Value In Naturalia Cube',
                  'pVersion', pVersion
                  );
EndIf;
# Mody 08.19.
# 4 kockávban lévő adatokat törli teljesen és tölti újra, sorrendben:
# Subsciption Plan
# report
# XP kocka
# súlyok


#   _____                                _           _     _                     _____    _                 
#  / ____|                              (_)         | |   (_)                   |  __ \  | |                
# | (___    _   _   _ __    ___    ___   _   _ __   | |_   _    ___    _ __     | |__) | | |   __ _   _ __  
#  \___ \  | | | | | '_ \  / __|  / __| | | | '_ \  | __| | |  / _ \  | '_ \    |  ___/  | |  / _` | | '_ \ 
#  ____) | | |_| | | |_) | \__ \ | (__  | | | |_) | | |_  | | | (_) | | | | |   | |      | | | (_| | | | | |
# |_____/   \__,_| | .__/  |___/  \___| |_| | .__/   \__| |_|  \___/  |_| |_|   |_|      |_|  \__,_| |_| |_|
#                  | |                      | |                                                             
#                  |_|                      |_|      

# A Subsciption kockába 3 lépésből áll:
# 1, Adatok törlése
# 2, Első hónap opening betöltése
# 3, Tranzakciók betöltése az tény hónapokra
# 4, Terminatet tranzakcióknak külön betöltője van
# 5, Visszakapcsolás tranzakcióknak külön hozzá kell adni
# 6, záróérték korrekció


pVersion = 'Base';
sCube = 'Subscription Plan';

# 1,
    ExecuteProcess( '}bedrock.cube.data.clear', 'pLogOutput', 0,
      'pStrictErrorHandling', 0,
    	'pCube', sCube,
    	'pView', '',
    	'pFilter', '',
    	'pFilterParallel', '',
    	'pParallelThreads', 0,
    	'pDimDelim', '&',
    	'pEleStartDelim', '¦', 'pEleDelim', '+',
    	'pCubeLogging', 0, 'pTemp', 1, 'pSandbox', '', 'pSubN', 0
	);


# 2,
# 202012 záró betöltése
ExecuteProcess('zSYS Analogic Load Opening Values',
   'pVersion', 'Base',
   'pPeriod', '202112'
  );

# 3, 
pSourceFile = 'transactions.csv';
pPeriodStart = '2022-01-01';
pPeriodEnd = '2023-09-31';
 
ExecuteProcess('zSYS Analogic Load Transactions',
                  'pPeriodStart', pPeriodStart,
                  'pPeriodEnd',pPeriodEnd);
                  
                  
# 4, Terminatet tranzakcióknak külön betöltője van
    ExecuteProcess('zSYS Analogic Load Terminated Values',
                  'pVersion', pVersion
                  );



# 5, Visszakapcsolás tranzakcióknak külön hozzá kell adni
    ExecuteProcess('zSYS Analogic Load Visszakapcsolt Values',
                  'pVersion', pVersion
                  );

	

#  _____                                  _   
# |  __ \                                | |  
# | |__) |   ___   _ __     ___    _ __  | |_ 
# |  _  /   / _ \ | '_ \   / _ \  | '__| | __|
# | | \ \  |  __/ | |_) | | (_) | | |    | |_ 
# |_|  \_\  \___| | .__/   \___/  |_|     \__|
#                 | |                         
#                 |_|   	

sCube = 'Subscription Report';
#pFilter = 'Subscription Report Measure ¦ Value';


# 1,
    ExecuteProcess( '}bedrock.cube.data.clear', 'pLogOutput', 0,
      'pStrictErrorHandling', 0,
    	'pCube', sCube,
    	'pView', '',
    	'pFilter', '',
    	'pFilterParallel', '',
    	'pParallelThreads', 0,
    	'pDimDelim', '&',
    	'pEleStartDelim', '¦', 'pEleDelim', '+',
    	'pCubeLogging', 0, 'pTemp', 1, 'pSandbox', '', 'pSubN', 0
	);
	
## 1,tény adatok betöltése a REPORT kockába
    ExecuteProcess('zSYS Analogic Load Closing Actual Values to Subscription Report',
                  'pVersion', pVersion
                  );
                  
                  
                  
# 2, korrekciós érték számítása
    ExecuteProcess('zSYS Analogic Load Closing Correction Delta to Subscription Plan',
                  'pVersion', pVersion
                  );

# 3
ExecuteProcess('zSYS Analogic Load Subscription Report Cube');


# __   __  _____  
# \ \ / / |  __ \ 
#  \ V /  | |__) |
#   > <   |  ___/ 
#  / . \  | |     
# /_/ \_\ |_|     
#                 
#

sCube = 'XP Planning';

# 1,
    ExecuteProcess( '}bedrock.cube.data.clear', 'pLogOutput', 0,
      'pStrictErrorHandling', 0,
    	'pCube', sCube,
    	'pView', '',
    	'pFilter', '',
    	'pFilterParallel', '',
    	'pParallelThreads', 0,
    	'pDimDelim', '&',
    	'pEleStartDelim', '¦', 'pEleDelim', '+',
    	'pCubeLogging', 0, 'pTemp', 1, 'pSandbox', '', 'pSubN', 0
	);

# 2
ExecuteProcess('zSYS Analogic Load XP Values ODBC');


# 3
ExecuteProcess('zSYS Analogic Load Closing values Into XP Values');

#__          __         _           _       _                           _     _        _               _   _         
# \ \        / /        (_)         | |     | |                         | |   | |      (_)             (_) | |        
#  \ \  /\  / /    ___   _    __ _  | |__   | |_      __ _   _ __     __| |   | |       _   _ __ ___    _  | |_   ___ 
#   \ \/  \/ /    / _ \ | |  / _` | | '_ \  | __|    / _` | | '_ \   / _` |   | |      | | | '_ ` _ \  | | | __| / __|
#    \  /\  /    |  __/ | | | (_| | | | | | | |_    | (_| | | | | | | (_| |   | |____  | | | | | | | | | | | |_  \__ \
#     \/  \/      \___| |_|  \__, | |_| |_|  \__|    \__,_| |_| |_|  \__,_|   |______| |_| |_| |_| |_| |_|  \__| |___/
#                             __/ |                                                                                   
#                            |___/          


# 1, kocka adatainak törlése 
# 2, súlyok betöltése a záróértékek alapján


sCube = 'Weight and Limit';
# 1,
    ExecuteProcess( '}bedrock.cube.data.clear', 'pLogOutput', 0,
      'pStrictErrorHandling', 0,
    	'pCube', sCube,
    	'pView', '',
    	'pFilter', '',
    	'pFilterParallel', '',
    	'pParallelThreads', 0,
    	'pDimDelim', '&',
    	'pEleStartDelim', '¦', 'pEleDelim', '+',
    	'pCubeLogging', 0, 'pTemp', 1, 'pSandbox', '', 'pSubN', 0
	);
	
# 2	
ExecuteProcess('zSYS Analogic Load Product Update Weights',
   'pRun', 1
  );



#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****



#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion
