#region Prolog
#****Begin: Generated Statements***
#****End: Generated Statements****
#Miki 2023.06.23.

sCube = 'XP Planning';
sDimName = 'Period';
sHierName = 'Period';
sSubsetName = 'Actual Period N level'; 
#Botond 05.29 Input periodrol javítva

sActualMonth = CellGetS('zSYS Maintenance Parameter', 'ActualMonth','S Type');
sActualYear= Subst(CellGetS('zSYS Maintenance Parameter', 'ActualMonth','S Type'), 1, 4);

sEndMonth = pPeriod|'12';
sENDMonthI = HierarchySubsetElementGetIndex(sDimName, sHierName, sSubsetName, sEndMonth, 1);


if(pPeriod @= sActualYear);
  sStartMonthI= HierarchySubsetElementGetIndex(sDimName, sHierName, sSubsetName, sActualMonth, 1);
  i = sStartMonthI;
while(i <= sEndMonthI);
  sPeriod = SubsetGetElementName(sDimName,sSubsetName, i);
   CellPutN(pValue, sCube, pVersion, sPeriod, pXP, 'Value');
   CellPutN(2, 'XP Planning', pVersion, sPeriod, pXP, 'Colors');
    ExecuteProcess('zSYS Xp Difference Calculation',
   'pPeriod', sPeriod,
   'pXP', pXP,
   'pValue', pValue
  );
  i = i + 1;
End;
elseif((Long(pPeriod)=4) & (pPeriod @<> sActualYear));
  sStartMonth = pPeriod|'01';
  sStartMonthI = HierarchySubsetElementGetIndex(sDimName, sHierName, sSubsetName, sStartMonth, 1);
  i = sStartMonthI;
while(i <= sEndMonthI);
  sPeriod = SubsetGetElementName(sDimName,sSubsetName, i);
    CellPutN(pValue, sCube, pVersion, sPeriod, pXP, 'Value');
   CellPutN(2, 'XP Planning', pVersion, sPeriod, pXP, 'Colors');
    ExecuteProcess('zSYS Xp Difference Calculation',
   'pPeriod', sPeriod,
   'pXP', pXP,
   'pValue', pValue
  );
  i = i + 1;
End;
else;
  CellPutN(pValue, 'XP Planning', pVersion, pPeriod, pXP, 'Value');
  CellPutN(2, 'XP Planning', pVersion, pPeriod, pXP, 'Colors');
  ExecuteProcess('zSYS Xp Difference Calculation',
     'pPeriod', pPeriod,
     'pXP', pXP,
     'pValue', pValue
    );
endif;


  
#endregion
#region Metadata
#****Begin: Generated Statements***
#****End: Generated Statements****





#endregion
#region Data
#****Begin: Generated Statements***
#****End: Generated Statements****

#endregion
#region Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****


# Módos Dávid 2024 02 13

sToday = Today(1);
CellPutS(sToday, '}ElementAttributes_Version', pVersion, 'Last Updated');
CellPutS(pUser, '}ElementAttributes_Version', pVersion, 'Last Updated By');




#endregion
